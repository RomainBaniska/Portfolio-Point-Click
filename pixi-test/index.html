<!DOCTYPE html>
<html>
<head>
    <title>PortFolio Pierre Castaing</title>
    <link rel="stylesheet" href="../css/body.css">
    <script src="https://pixijs.download/release/pixi.js"></script>
    <!-- <script src="js/pixi.dev.js"></script> -->

    <script type="module">
        const app = new PIXI.Application();

        // Configuration de la largeur maximale adaptée à la taille de l'écran si plus petit
        const maxWidth = 1440;
        const width = Math.min(window.innerWidth, maxWidth);
        const aspectRatio = 16 / 9;
        const height = width / aspectRatio;

        await app.init({ 
            width: width,
            height: height,
            // resizeTo: window, 
            backgroundColor: 0x1099bb,
            // resolution: window.devicePixelRatio || 1,
        });
        document.body.appendChild(app.canvas);

        // // Charger l'image de fond
        await PIXI.Assets.load('../sprites/home.png');
        const background = PIXI.Sprite.from('../sprites/home.png');
        app.stage.addChild(background);


        // Fonction pour ajuster la taille du canvas en temps réel
        function adjustCanvasSize() {
            app.renderer.resize(window.innerWidth, window.innerHeight);
            background.width = app.screen.width;
            background.height = app.screen.height;
        }

        // Applique le redimensionnement à chaque événement 'resize'
        window.addEventListener('resize', adjustCanvasSize);

        // Optionnel : pour s'assurer que tout est bien redimensionné dès le chargement initial
        adjustCanvasSize();



        // Ajout du sprite "Romain" et ses animations

        const loader = new PIXI.Loader();

        loader.shared
        .add('sample', 'sample.png')
        .add('romain facetalk', '../sprites/TALK/romain face talk.json')
        .add('romain walk left', '../sprites/WALK/romain walk left.json')
        .add('romain walk right', '../sprites/WALK/romain walk right.json')
        .load(playerSetup);


        function playerSetup() {
                const spriteSheet1 = PIXI.Loader.shared.resources['romain face talk'].spritesheet;
                const spriteSheet2 = PIXI.Loader.shared.resources['romain walk left'].spritesheet;
                const spriteSheet3 = PIXI.Loader.shared.resources['romain walk right'].spritesheet;

                // Crée des animations pour chaque état (idle, marche avant, marche arrière)
                const idle = new PIXI.AnimatedSprite(spriteSheet1.animations['idle']);
                const walkLeft = new PIXI.AnimatedSprite(spriteSheet2.animations['walkLeft']);
                const walkRight = new PIXI.AnimatedSprite(spriteSheet3.animations['walkRight']);

                // Positionner l'animation et l'ajouter au stage
                idle.position.set(100, 100);
                walkLeft.position.set(100, 100);
                walkRight.position.set(100, 100);

                app.stage.addChild(idle);
                
                // On change l'animation en fonction des actions du personnage
                function switchAnimation(state) {
                    if (state === 'idle') {
                    idle.play();
                    walkLeft.stop();
                    walkRight.stop();
                    } else if (state === 'walkLeft') {
                    walkLeft.play();
                    idle.stop();
                    walkRight.stop();
                    } else if (state === 'walkRight') {
                    walkRight.play();
                    idle.stop();
                    walkLeft.stop();
                    }
                }
                }


    </script>
</head>
<body>
    <!-- <h1>Hello PixiJS</h1> -->
</body>

</html>